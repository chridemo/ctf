<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pentesting Notes</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

:root {
    --bg-primary: #0d0d0d;
    --bg-secondary: #1a1a1a;
    --bg-tertiary: #262626;
    --accent: #ffffff;
    --accent-dim: #a3a3a3;
    --text-primary: #ffffff;
    --text-secondary: #737373;
    --border: #404040;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: var(--bg-primary);
    color: var(--text-primary);
    overflow: hidden;
}

.container { display: flex; height: 100vh; }

/* SIDEBAR */
.sidebar {
    width: 280px;
    background: var(--bg-secondary);
    border-right: 1px solid var(--border);
    display: flex;
    flex-direction: column;
}

.sidebar-header { padding: 24px 20px; border-bottom: 1px solid var(--border); }
.sidebar-header h1 { font-size: 18px; color: var(--text-primary); font-weight: 600; letter-spacing: -0.5px; }

.sidebar-content { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
.search-sidebar { padding: 16px 20px; border-bottom: 1px solid var(--border); }
.search-sidebar-input {
    width: 100%;
    padding: 10px 12px;
    background: var(--bg-tertiary);
    border: 1px solid var(--border);
    border-radius: 6px;
    color: var(--text-primary);
    font-size: 13px;
    transition: all 0.2s;
}
.search-sidebar-input:focus { outline: none; border-color: var(--accent-dim); }
.search-sidebar-input::placeholder { color: var(--text-secondary); }

.sidebar-nav { flex: 1; overflow-y: auto; padding: 16px 0; }
.nav-item {
    padding: 10px 20px;
    cursor: pointer;
    transition: all 0.15s;
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 14px;
}
.nav-item:hover { background: var(--bg-tertiary); color: var(--text-primary); }
.nav-item.active { background: var(--bg-tertiary); color: var(--text-primary); border-left: 2px solid var(--accent); font-weight: 500; }

/* MAIN CONTENT */
.main-content { flex: 1; display: flex; flex-direction: column; overflow: hidden; background: var(--bg-primary); }
.file-viewer { flex: 1; overflow-y: auto; padding: 48px 64px; }
.file-content { max-width: 800px; margin: 0 auto; }

.content h2 { font-size: 24px; margin-top: 40px; margin-bottom: 16px; color: var(--text-primary); font-weight: 600; letter-spacing: -0.3px; }
.content h3 { font-size: 18px; margin-top: 32px; margin-bottom: 12px; color: var(--accent-dim); font-weight: 600; }
.content p, .content ul, .content ol { line-height: 1.7; margin-bottom: 16px; color: var(--text-secondary); font-size: 15px; }
.content li { margin-bottom: 10px; line-height: 1.7; font-size: 15px; }
.content code { background: var(--bg-secondary); padding: 3px 7px; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 13px; color: var(--text-primary); border: 1px solid var(--border); }
.content pre { background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; margin: 24px 0; border: 1px solid var(--border); }
.content pre code { background: none; padding: 0; border: none; color: var(--accent-dim); font-size: 14px; line-height: 1.6; }
.content blockquote { border-left: 3px solid var(--accent-dim); padding-left: 20px; margin: 24px 0; color: var(--text-secondary); font-style: italic; }
.content strong { color: var(--text-primary); font-weight: 600; }

.empty-state { display: flex; align-items: center; justify-content: center; height: 100%; text-align: center; color: var(--text-secondary); padding: 48px; }
.empty-state-content h2 { font-size: 24px; color: var(--text-primary); margin-bottom: 12px; }
.empty-state-content p { font-size: 15px; color: var(--text-secondary); }

.link { text-decoration: underline; cursor: pointer; }
.link:hover { color: var(--accent-dim); }

::-webkit-scrollbar { width: 10px; height: 10px; }
::-webkit-scrollbar-track { background: var(--bg-primary); }
::-webkit-scrollbar-thumb { background: var(--bg-tertiary); border-radius: 5px; border: 2px solid var(--bg-primary); }
::-webkit-scrollbar-thumb:hover { background: var(--border); }

@media (max-width: 768px) {
    .sidebar { position: fixed; left: -280px; z-index: 1000; transition: left 0.3s; height: 100vh; }
    .sidebar.open { left: 0; }
    .file-viewer { padding: 24px 20px; }
}
</style>
</head>
<body>
<div class="container">
    <aside class="sidebar">
        <div class="sidebar-header"><h1>PENTESTING NOTES</h1></div>
        <div class="sidebar-content">
            <div class="search-sidebar">
                <input type="text" id="searchInput" class="search-sidebar-input" placeholder="Search files...">
            </div>
            <nav class="sidebar-nav" id="sidebarNav"></nav>
        </div>
    </aside>
    <main class="main-content">
        <div class="file-viewer">
            <div class="file-content" id="fileContent">
                <div class="empty-state">
                    <div class="empty-state-content">
                        <h2>Select a file</h2>
                        <p>Choose a document from the sidebar to view its contents</p>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<script>
const files = [
    { name: "Introduction to Cybersecurity", path: "intro-cybersecurity.html" },
    { name: "Introduction to Pentesting", path: "intro-pentesting.html" },
    { name: "Passive Reconnaissance", path: "recon-passive.html" },
    { name: "Active Reconnaissance", path: "recon-active.html" }
];

const sidebar = document.getElementById("sidebarNav");
const searchInput = document.getElementById("searchInput");
const fileContent = document.getElementById("fileContent");

function renderSidebar(listFiles) {
    sidebar.innerHTML = "";
    listFiles.forEach(f => {
        const item = document.createElement("div");
        item.className = "nav-item";
        item.textContent = f.name;
        item.onclick = () => loadFile(f.path, f.name);
        sidebar.appendChild(item);
    });
}

async function loadFile(path, highlightName=null) {
    try {
        const response = await fetch("files/" + path);
        const text = await response.text();
        fileContent.innerHTML = `<div class="content">${parseContent(text)}</div>`;

        // Evidenzia la voce attiva in sidebar
        document.querySelectorAll(".nav-item").forEach(el => el.classList.remove("active"));
        if(highlightName) {
            const el = Array.from(document.querySelectorAll(".nav-item"))
                .find(e => e.textContent === highlightName);
            if(el) el.classList.add("active");
        }
    } catch(e) {
        fileContent.innerHTML = `<p style="color:red;">Errore nel caricamento del file: ${path}</p>`;
    }
}

function parseLinks(text) {
    return text.replace(/\[\[(.+?)\]\]/g, (match, p1) => {
        const file = files.find(f => f.name.toLowerCase() === p1.toLowerCase() || f.path.toLowerCase() === p1.toLowerCase());
        if(file) {
            return `<span class="link" onclick="loadFile('${file.path}','${file.name}')">${file.name}</span>`;
        }
        return p1;
    });
}
    
window.loadFile = loadFile;
    
function parseContent(text) {
    const lines = text.split("\n");
    let html = "", insideCode=false, insideList=false;

    lines.forEach(line => {
        line = line.trimEnd();
        if(line.startsWith("ยง")) { html += insideCode ? "</code></pre>" : "<pre><code>"; insideCode=!insideCode; return; }
        if(insideCode) { html += line.replace(/</g,"&lt;")+"\n"; return; }
        if(line.startsWith("-")) { if(!insideList){html+="<ul>";insideList=true;} html+=`<li>${parseLinks(line.substring(1).trim())}</li>`; return; }
        else if(insideList){ html+="</ul>"; insideList=false; }
        if(line.startsWith("**")) { html+=`<h2>${parseLinks(line.substring(2).trim())}</h2>`; return; }
        if(line.startsWith("*")) { html+=`<h1>${parseLinks(line.substring(1).trim())}</h1>`; return; }
        if(line==="---") { html+="<hr>"; return; }
        if(line.trim()!=="") html+=`<p>${parseLinks(line.trim())}</p>`;
    });
    if(insideList) html+="</ul>";
    return html;
}

document.addEventListener("DOMContentLoaded", () => {
    renderSidebar(files);

    searchInput.addEventListener("input", () => {
        const q = searchInput.value.toLowerCase();
        const filtered = files.filter(f => f.name.toLowerCase().includes(q));
        renderSidebar(filtered);
    });

    // Mostra automaticamente il primo file all'avvio
    if(files.length>0) loadFile(files[0].path, files[0].name);
});
</script>
</body>
</html>
