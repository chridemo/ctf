<!DOCTYPE html>
<head>
<meta charset="UTF-8">
<title>chridemo</title>

<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">

<style>
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    background: radial-gradient(circle at top, #0d1117, #010409);
    font-family: "JetBrains Mono", monospace;
    color: #c9d1d9;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
}

/* ===== App Window ===== */
.app {
    width: 94%;
    height: 90%;
    display: flex;
    border-radius: 10px;
    background: #0d1117;
    box-shadow:
        0 8px 30px rgba(0, 0, 0, 0.5),
        inset 0 0 0 1px rgba(106, 255, 154, 0.1);
    overflow: hidden;
    position: relative;
    border: 1px solid rgba(106, 255, 154, 0.15);
}

/* ===== Sidebar ===== */
.sidebar {
    width: 240px;
    background: #161b22;
    padding: 24px 20px;
    border-right: 1px solid rgba(106, 255, 154, 0.15);
    color: #c9d1d9;
    overflow-y: auto;
}

.sidebar::-webkit-scrollbar {
    width: 6px;
}

.sidebar::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.2);
}

.sidebar::-webkit-scrollbar-thumb {
    background: rgba(106, 255, 154, 0.2);
    border-radius: 3px;
}

.sidebar .title {
    font-weight: 600;
    margin-bottom: 16px;
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: #8b949e;
}

.folder {
    margin-top: 10px;
    cursor: pointer;
    color: #6aff9a;
    transition: all 0.2s ease;
    padding: 6px 10px;
    border-radius: 5px;
    font-weight: 500;
}

.folder:hover {
    background: rgba(106, 255, 154, 0.08);
    padding-left: 14px;
}

.folder.open {
    color: #6aff9a;
}

.file {
    margin-left: 20px;
    margin-top: 6px;
    color: #8b949e;
    cursor: pointer;
    transition: all 0.2s ease;
    padding: 5px 10px;
    border-radius: 5px;
    position: relative;
}

.file::before {
    content: "ðŸ“„ ";
    opacity: 0.5;
}

.file:hover {
    color: #c9d1d9;
    background: rgba(106, 255, 154, 0.05);
    padding-left: 14px;
}

/* ===== Terminal ===== */
.terminal {
    flex: 1;
    padding: 24px;
    overflow-y: auto;
    background: #0d1117;
    position: relative;
}

.terminal::-webkit-scrollbar {
    width: 8px;
}

.terminal::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.2);
}

.terminal::-webkit-scrollbar-thumb {
    background: rgba(106, 255, 154, 0.2);
    border-radius: 4px;
}

.line {
    margin: 3px 0;
    white-space: pre-wrap;
    line-height: 1.6;
    animation: fadeIn 0.2s ease;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(-2px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.input-line {
    display: flex;
    animation: fadeIn 0.2s ease;
}

.prompt {
    color: #6aff9a;
    margin-right: 10px;
    font-weight: 500;
    white-space: nowrap;
}

input {
    flex: 1;
    background: transparent;
    border: none;
    outline: none;
    color: #c9d1d9;
    font-family: inherit;
    font-size: 15px;
    caret-color: #6aff9a;
}

input::selection {
    background: rgba(106, 255, 154, 0.2);
}

/* ===== Special Text Colors ===== */

.error {
    color: #FD6F6F;
}

.info {
    color: #f8f8f8;
}

.warning {
    color: #ffcc99;
}

/* ===== Banner ===== */
.banner {
    color: #6aff9a;
    margin-bottom: 8px;
    font-weight: 500;
}

/* ===== File content styling ===== */
.file-content {
    padding: 14px;
    margin: 10px 0;
    border-left: 3px solid rgba(106, 255, 154, 0.4);
    background: rgba(106, 255, 154, 0.04);
    border-radius: 6px;
}

.file-title {
    color: #6aff9a;
    font-weight: 600;
    font-size: 16px;
    margin-bottom: 8px;
}

.file-line {
    color: #8b949e;
    margin: 4px 0;
}
</style>
</head>

<body>

<div class="app">

    <div class="sidebar">
        <div class="title">ðŸ“‚ filesystem</div>

        <div class="folder" onclick="toggle('htb')" id="folder-htb">â–¸ htb</div>
        <div id="htb" style="display:none;">
            <div class="file" onclick="runCat('htb/lame.md')">lame.md</div>
            <div class="file" onclick="runCat('htb/jerry.md')">jerry.md</div>
            <div class="file" onclick="runCat('htb/nibbles.md')">nibbles.md</div>
        </div>

        <div class="folder" onclick="toggle('thm')" id="folder-thm">â–¸ thm</div>
        <div id="thm" style="display:none;">
            <div class="file" onclick="runCat('thm/blue.md')">blue.md</div>
            <div class="file" onclick="runCat('thm/kenobi.md')">kenobi.md</div>
            <div class="file" onclick="runCat('thm/overpass.md')">overpass.md</div>
        </div>
    </div>

    <div class="terminal" id="output"></div>

</div>

<script>
const files = {
    "htb/lame.md": {
        content: "Lame - HTB\n\nuser.txt\nroot.txt",
        route: "/pentest-workflow/lame"
    },
    "htb/jerry.md": {
        content: "Jerry - HTB\n\nTomcat RCE",
        route: "/pentest-workflow/jerry"
    },
    "htb/nibbles.md": {
        content: "Nibbles - HTB\n\nFile upload exploit",
        route: "/pentest-workflow/nibbles"
    },
    "thm/blue.md": {
        content: "Blue - THM\n\nEternalBlue",
        route: "/pentest-workflow/blue"
    },
    "thm/kenobi.md": {
        content: "Kenobi - THM\n\nSamba + ProFTPD",
        route: "/pentest-workflow/kenobi"
    },
    "thm/overpass.md": {
        content: "Overpass - THM\n\nCron abuse",
        route: "/pentest-workflow/overpass"
    }
};

let cwd = "~";
let commandHistory = [];
let historyIndex = -1;
const out = document.getElementById("output");

function print(text, className = "") {
    const div = document.createElement("div");
    div.className = `line ${className}`;
    div.innerHTML = text;
    out.appendChild(div);
}

function printFileContent(content) {
    const lines = content.split("\n");
    const div = document.createElement("div");
    div.className = "file-content";
    
    lines.forEach((line, idx) => {
        if (idx === 0) {
            const title = document.createElement("div");
            title.className = "file-title";
            title.textContent = line;
            div.appendChild(title);
        } else if (line.trim()) {
            const fileLine = document.createElement("div");
            fileLine.className = "file-line";
            fileLine.textContent = line;
            div.appendChild(fileLine);
        }
    });
    
    out.appendChild(div);
}

function prompt() {
    const line = document.createElement("div");
    line.className = "input-line";

    const p = document.createElement("div");
    p.className = "prompt";
    p.textContent = `librewolf@ctf:${cwd}$`;

    const input = document.createElement("input");

    input.addEventListener("keydown", e => {
        if (e.key === "Enter") {
            const cmd = input.value.trim();
            input.disabled = true;
            
            if (cmd) {
                commandHistory.unshift(cmd);
                historyIndex = -1;
            }
            
            handle(cmd);
            prompt();
            out.scrollTop = out.scrollHeight;
        } else if (e.key === "ArrowUp") {
            e.preventDefault();
            if (historyIndex < commandHistory.length - 1) {
                historyIndex++;
                input.value = commandHistory[historyIndex];
            }
        } else if (e.key === "ArrowDown") {
            e.preventDefault();
            if (historyIndex > 0) {
                historyIndex--;
                input.value = commandHistory[historyIndex];
            } else {
                historyIndex = -1;
                input.value = "";
            }
        } else if (e.key === "Tab") {
            e.preventDefault();
            autocomplete(input);
        }
    });

    line.appendChild(p);
    line.appendChild(input);
    out.appendChild(line);
    input.focus();
}

function autocomplete(input) {
    const val = input.value.trim();
    const parts = val.split(" ");
    
    if (parts[0] === "cat" && parts.length === 2) {
        const prefix = parts[1];
        const matches = Object.keys(files).filter(f => f.startsWith(prefix));
        
        if (matches.length === 1) {
            input.value = `cat ${matches[0]}`;
        } else if (matches.length > 1) {
            print(`\n<span class="info">${matches.join("  ")}</span>`);
        }
    } else if (parts[0] === "cd" && parts.length === 2) {
        const prefix = parts[1];
        const dirs = ["htb", "thm", "~"];
        const matches = dirs.filter(d => d.startsWith(prefix));
        
        if (matches.length === 1) {
            input.value = `cd ${matches[0]}`;
        }
    }
}

function handle(cmd) {
    if (!cmd) return;

    const [c, ...args] = cmd.split(" ");
    const arg = args.join(" ");

    switch (c) {
        case "ls": {
            if (cwd === "~") {
                print("<span class='info'>htb</span>  <span class='info'>thm</span>");
            } else {
                const filesList = Object.keys(files)
                    .filter(f => f.startsWith(cwd))
                    .map(f => `<span class='success'>${f.split("/")[1]}</span>`)
                    .join("  ");
                print(filesList || "<span class='error'>empty directory</span>");
            }
            break;
        }
        case "cd": {
            if (arg === "" || arg === "~") {
                cwd = "~";
                print("<span class='success'>changed directory to ~</span>");
            } else if (arg === "htb" || arg === "thm") {
                cwd = arg;
                print(`<span class='success'>changed directory to ${arg}</span>`);
            } else if (arg === "..") {
                cwd = "~";
                print("<span class='success'>changed directory to ~</span>");
            } else {
                print(`<span class='error'>cd: no such file or directory: ${arg}</span>`);
            }
            break;
        }
        case "cat": {
            const path = arg.includes("/")
                ? arg
                : (cwd === "~" ? arg : `${cwd}/${arg}`);

            if (files[path]) {
                printFileContent(files[path].content);
                
                // Navigate to the route
                setTimeout(() => {
                    print(`<span class='warning'>â†’ Redirecting to ${files[path].route}...</span>`);
                    setTimeout(() => {
                        window.location.href = files[path].route;
                    }, 800);
                }, 500);
            } else {
                print(`<span class='error'>cat: ${path}: No such file or directory</span>`);
            }
            break;
        }
        case "pwd":
            print(`<span class='info'>${cwd === "~" ? "/home/librewolf" : `/home/librewolf/${cwd}`}</span>`);
            break;
        case "clear":
            out.innerHTML = "";
            printBanner();
            break;
        case "help":
            print("<span class='info'>Available commands:</span>");
            print("  <span class='success'>ls</span>      - list directory contents");
            print("  <span class='success'>cd</span>      - change directory");
            print("  <span class='success'>cat</span>     - display file contents");
            print("  <span class='success'>pwd</span>     - print working directory");
            print("  <span class='success'>clear</span>   - clear terminal");
            print("  <span class='success'>help</span>    - show this message");
            print("\n<span class='warning'>TIP: Use TAB for autocompletion, â†‘/â†“ for history</span>");
            break;
        case "whoami":
            print("<span class='success'>librewolf</span>");
            break;
        default:
            print("");
            print(`<span class='error'>bash: ${c}: command not found</span>`);
            print("<span class='info'>Type 'help' for available commands</span>");
    }
}

function toggle(id) {
    const el = document.getElementById(id);
    const folder = document.getElementById(`folder-${id}`);
    
    if (el.style.display === "none") {
        el.style.display = "block";
        folder.textContent = "â–¾ " + id;
        folder.classList.add("open");
    } else {
        el.style.display = "none";
        folder.textContent = "â–¸ " + id;
        folder.classList.remove("open");
    }
}

function runCat(f) {
    // Simulate typing the command
    const inputs = document.querySelectorAll("input");
    const lastInput = inputs[inputs.length - 1];
    if (lastInput && !lastInput.disabled) {
        lastInput.value = `cat ${f}`;
        lastInput.dispatchEvent(new KeyboardEvent("keydown", { key: "Enter" }));
    }
}

/*function printBanner() {
    const banner = String.raw`<pre style='font-family: monospace; white-space: pre; color: #6aff9a;'>
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚    ____ _   _ ____  ___ ____  _____ __  __  ___      __        ______  ___ _____ _____ _   _ ____  ____    â”‚
â”‚   / ___| | | |  _ \|_ _|  _ \| ____|  \/  |/ _ \     \ \      / /  _ \|_ _|_   _| ____| | | |  _ \/ ___|   â”‚
â”‚  | |   | |_| | |_) || || | | |  _| | |\/| | | | |     \ \ /\ / /| |_) || |  | | |  _| | | | | |_) \___ \   â”‚
â”‚  | |___|  _  |  _ < | || |_| | |___| |  | | |_| |      \ V  V / |  _ < | |  | | | |___| |_| |  __/ ___) |  â”‚
â”‚   \____|_| |_|_| \_\___|____/|_____|_|  |_|\___/        \_/\_/  |_| \_\___| |_| |_____|\___/|_|   |____/   â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
</pre>`;
    print(banner);
    print("");
    print("<span class='info'>Type <span class='success'>help</span> to see available commands</span>");
    print("");
}*/

function printBanner() {
    print("<span class='banner'>â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>");
    print("<span class='banner'>â”‚  CTF Writeups Archive                  â”‚</span>");
    print("<span class='banner'>â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>");
    print("");
    print("<span class='info'>Type <span class='success'>help</span> to see available commands</span>");
    print("");
}

printBanner();
prompt();    
    
// Focus on load
window.addEventListener("load", () => {
    const input = document.querySelector("input");
    if (input) input.focus();
});

// Refocus on click
document.addEventListener("click", () => {
    const inputs = document.querySelectorAll("input");
    const lastInput = inputs[inputs.length - 1];
    if (lastInput && !lastInput.disabled) {
        lastInput.focus();
    }
});
</script>

</body>
</html>
